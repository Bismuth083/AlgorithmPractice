# 素数判定アルゴリズム

## 概要

- 内容: ある数が素数かどうか、何を約数に持つかなどを判定するアルゴリズム
- 計算量:
  - 素数判定: O(√n)
  - 素数列挙 (エラトステネスの篩): O(n log log n)
  - 素因数(試し割り法): O(√n)
- 前提知識: 特になし

## 説明

素数とは、1とその数自身以外に約数を持たない自然数のことである。1は素数に含まないのが一般的な定義である。

ここで重要なのは、素数は2か、3以上の自然数しか存在しないことである。
また、素数でない自然数(合成数とも言う)$n$は、必ず$2 < m < |\sqrt{n}|$を満たす約数$m$を持つ($m$で割り切れる)。

したがって、$n$が素数かをチェックしたいなら、

$$2, 3, 5, 7, 9, ... , |\sqrt{n}|$$

のうち、いずれかの数で割り切れるかを確認すれば良い(上のどの数でも割り切れないならば、素数である)。

## 実装の方針

### 素数判定

- 2で割り切れるかを確かめる。割り切れるなら素数ではない。
- 3で割り切れるかを確かめる。割り切れるなら素数ではない。
- 5で割り切れるかを確かめる。割り切れるなら素数ではない。
- ...
- $|\sqrt{n}|$で割り切れるかを確かめる。割り切れるなら素数ではない。

上のいずれのでも割り切れなければ、素数である。

### エラトステネスの篩の実装

- まず、2と3以上の奇数を「素数の候補」にする。
- 次に、**3以外の**3の倍数である数全てを「素数の候補」から外す。
- 次に、**5以外の**5の倍数である数全てを「素数の候補」から外す。
- ...
- **9**は既に「素数の候補」から外されているため、**無視する**。
- **11**は「素数の候補」のままであるため、11以外の11の倍数である数全てを「素数の候補」から外す。

これを、$\sqrt{n}$まで繰り返す。これが全て終わった時点で「素数候補」である数は全て素数である。

### 試し割り法

- 2で割れるだけ割る。割れたら割れた回数だけリストに2を追加する。
- 3で割れるだけ割る。割れたら割れた回数だけリストに3を追加する。
- 5で割れるだけ割る。割れたら割れた回数だけリストに5を追加する。
- ...
- $|\sqrt{n}|$で割れるだけ割る。割れたら割れた回数だけリストに$|\sqrt{n}|$を追加する。

## 応用先

### AOJ 問題ID

- [ALDS1_1_C](https://onlinejudge.u-aizu.ac.jp/courses/lesson/1/ALDS1/1/ALDS1_1_C)
- [NTL_1_A](https://onlinejudge.u-aizu.ac.jp/courses/library/6/NTL/1/NTL_1_A)

## リファレンス

- [AtCoder 版！マスター・オブ・整数 (素因数分解編)](https://qiita.com/drken/items/a14e9af0ca2d857dad23)
- [エラトステネスの篩 - Wikipedia](https://ja.wikipedia.org/wiki/%E3%82%A8%E3%83%A9%E3%83%88%E3%82%B9%E3%83%86%E3%83%8D%E3%82%B9%E3%81%AE%E7%AF%A9)
